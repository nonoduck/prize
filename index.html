<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç­ç´šé©šå–œæˆ³æˆ³æ¨‚ (ç‚«éº—å½ˆçª—ç‰ˆ)</title>
    <style>
        :root {
            --primary-color: #4db8ff;
            --secondary-color: #fffa65;
            --bg-color: #f0f4f7;
            --box-color: #fff;
        }

        body {
            font-family: "Microsoft JhengHei", "PingFang TC", sans-serif;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden; /* é˜²æ­¢å½ˆçª—å‹•ç•«æ™‚å‡ºç¾å·è»¸ */
        }

        .header { text-align: center; margin-bottom: 20px; }
        h1 { color: #2f3542; font-size: 2.5rem; margin: 10px 0; text-shadow: 2px 2px 0px white; }
        p { color: #57606f; font-size: 1.1rem; }

        /* --- ä¹å®®æ ¼å€åŸŸ --- */
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 110px);
            grid-template-rows: repeat(3, 110px);
            gap: 15px;
            background-color: #fff;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 5px solid var(--primary-color);
        }

        .cell {
            position: relative;
            width: 110px; height: 110px;
            background-color: #fff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            overflow: hidden; /* é‡è¦ï¼šé˜²æ­¢å…§å®¹æº¢å‡º */
        }

        /* è¦†è“‹ç”¨çš„ç´™å¼µ */
        .cover {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, var(--secondary-color), #f9ca24);
            border: 2px solid #f0932b;
            border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            color: #d35400; font-weight: 900; font-size: 2rem;
            z-index: 2;
            transition: all 0.3s ease-out; /* åŠ å¿«ä¸€é»é€Ÿåº¦ */
        }

        /* æˆ³ç ´å¾Œçš„å‹•ç•«ï¼šè“‹å­å¿«é€Ÿç¸®å°æ¶ˆå¤± */
        .cell.opened .cover {
            opacity: 0;
            transform: scale(0.1);
            pointer-events: none;
        }

        /* æ ¼å­è£¡çš„å…§å®¹ (å¹³å¸¸æ˜¯éš±è—æˆ–ç¸®å°çš„ï¼Œç­‰å½ˆçª—é¡¯ç¤º) */
        .cell-content-hidden {
            opacity: 0.3;
            transform: scale(0.8);
            transition: all 0.5s;
            /* é€™è£¡çš„æ¨£å¼åªæ˜¯ç‚ºäº†åœ¨æ ¼å­è£¡ç¨å¾®é¡¯ç¤ºï¼Œé‡é»åœ¨å½ˆçª— */
            font-size: 0.8rem; 
            text-align: center;
        }
        .cell.opened .cell-content-hidden {
            opacity: 1;
             transform: scale(1);
        }


        /* --- æ–°å¢ï¼šç‚«éº—å½ˆçª—å±¤ --- */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* åŠé€æ˜é»‘è‰²èƒŒæ™¯ */
            display: flex; align-items: center; justify-content: center;
            z-index: 100; /* æœ€ä¸Šå±¤ */
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            backdrop-filter: blur(5px); /* èƒŒæ™¯æ¨¡ç³Šæ•ˆæœ (æ”¯æ´çš„ç€è¦½å™¨) */
        }

        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* å½ˆçª—å…§å®¹æ¡† */
        .popup-box {
            background-color: #fff;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 80%;
            transform: scale(0.5); /* åˆå§‹ç‹€æ…‹ç¸®å° */
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); /* å½ˆè·³è²èŒ²æ›²ç·š */
        }

        .overlay.active .popup-box {
            transform: scale(1); /* è®Šå›åŸå¤§å°ï¼Œé…åˆä¸Šé¢çš„æ›²ç·šæœƒç”¢ç”Ÿå½ˆè·³æ„Ÿ */
            opacity: 1;
        }

        /* å½ˆçª—è£¡é¢çš„æ–‡å­—æ¨£å¼ */
        #popup-content {
            font-size: 3rem; /* è¶…å¤§å­—é«” */
            font-weight: 800;
            color: #2f3542;
            line-height: 1.2;
            margin-bottom: 20px;
            /* æ·»åŠ ä¸€é»æ–‡å­—ç‰¹æ•ˆ */
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.2);
        }
        
        .close-hint { color: #aaa; font-size: 1rem; margin-top: 20px; cursor: pointer;}


        /* --- æ§åˆ¶æŒ‰éˆ• --- */
        .controls { margin-top: 30px; }
        .btn {
            padding: 12px 25px; background-color: var(--primary-color); color: white;
            border: none; border-radius: 50px; cursor: pointer;
            font-size: 1.1rem; font-weight: bold; transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(77, 184, 255, 0.4);
        }
        .btn:hover { background-color: #2980b9; transform: translateY(-2px); }
    </style>
</head>
<body>

    <div class="header">
        <h1>âœ¨ ç­ç´šå¹¸é‹æˆ³æˆ³æ¨‚ âœ¨</h1>
        <p>é»æ“Šæ ¼å­ï¼Œé©šå–œé¦¬ä¸Šè·³å‡ºä¾†ï¼</p>
    </div>

    <div class="grid" id="pokeGrid">
        </div>

    <div class="controls">
        <button class="btn" onclick="resetGame()">é‡æ–°æ´—ç‰Œä¸¦é–‹å§‹</button>
    </div>

    <div class="overlay" id="resultOverlay" onclick="closePopup()">
        <div class="popup-box">
            <div id="popup-content"></div>
            <div class="close-hint">(é»æ“Šä»»æ„è™•é—œé–‰)</div>
        </div>
    </div>

    <script>
        const prizeList = [
            "ğŸ›Œ<br>èººè‘—åˆç¡å¡", "âœï¸<br>ç”Ÿå­—å°‘3å€‹å­—", "ğŸª‘<br>ä»»é¸åº§ä½ä¸€å¤©",
            "ğŸµ<br>åˆé¤é»æ­Œå¡", "ğŸ¥©<br>è±¬æ’åŠ å€", "ğŸµ<br>åˆé¤é»æ­Œå¡",
            "ğŸª‘<br>ä»»é¸åº§ä½ä¸€å¤©", "âœï¸<br>ç”Ÿå­—å°‘3å€‹å­—", "ğŸµ<br>åˆé¤é»æ­Œå¡"
        ];

        // è¨˜éŒ„å·²ç¶“æˆ³éçš„æ ¼å­ç´¢å¼•
        let openedIndices = [];

        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        // ç•¶å‰çš„çå“é †åº
        let currentPrizes = [];

        function createGrid() {
            const grid = document.getElementById('pokeGrid');
            grid.innerHTML = '';
            openedIndices = []; // é‡ç½®å·²é–‹åˆ—è¡¨
            currentPrizes = shuffle([...prizeList]); // æ´—ç‰Œ

            currentPrizes.forEach((prize, index) => {
                const cell = document.createElement('div');
                cell.className = 'cell';
                // å„²å­˜ç´¢å¼•ä»¥ä¾¿è¿½è¹¤
                cell.dataset.index = index;
                
                const cover = document.createElement('div');
                cover.className = 'cover';
                cover.innerText = index + 1;

                // é€™è£¡åªæ”¾ä¸€å€‹éš±è—çš„ placeholderï¼Œå¯¦éš›å…§å®¹åœ¨å½ˆçª—é¡¯ç¤º
                const hiddenContent = document.createElement('div');
                hiddenContent.className = 'cell-content-hidden';
                hiddenContent.innerHTML = prize;

                cell.appendChild(hiddenContent);
                cell.appendChild(cover);

                // --- ä¿®æ”¹å¾Œçš„é»æ“Šäº‹ä»¶ ---
                cell.onclick = function() {
                    const idx = parseInt(this.dataset.index);
                    // å¦‚æœé‚„æ²’é–‹é
                    if (!openedIndices.includes(idx)) {
                        // 1. æ¨™è¨˜ç‚ºå·²é–‹ï¼Œè®“è“‹å­æ¶ˆå¤±
                        this.classList.add('opened');
                        openedIndices.push(idx);
                        
                        // 2. è§¸ç™¼å½ˆçª—é¡¯ç¤ºçµæœ
                        showPopup(prize);
                    }
                };
                grid.appendChild(cell);
            });
        }

        // --- æ–°å¢ï¼šé¡¯ç¤ºå½ˆçª—å‡½å¼ ---
        function showPopup(content) {
            const overlay = document.getElementById('resultOverlay');
            const popupContent = document.getElementById('popup-content');
            
            // è¨­å®šå½ˆçª—å…§å®¹
            popupContent.innerHTML = content;
            
            // é¡¯ç¤ºé®ç½©ï¼Œè§¸ç™¼ CSS å‹•ç•«
            overlay.classList.add('active');
        }

        // --- æ–°å¢ï¼šé—œé–‰å½ˆçª—å‡½å¼ ---
        function closePopup() {
             const overlay = document.getElementById('resultOverlay');
             overlay.classList.remove('active');
        }

        function resetGame() {
            if (confirm('ç¢ºå®šè¦é‡æ–°é–‹å§‹ä¸¦æ‰“äº‚é †åºå—ï¼Ÿ')) {
                createGrid();
            }
        }

        window.onload = createGrid;
    </script>
</body>
</html>
